# MicroPython firmware builder.
The tag is the release version of micropython that the container will build.

## Setup
To build custom firmware your project should have this layout:
- /modules - Modules that has to be frozen in the firmware. There is no need to have /manifest.py it is generated before build.
- /lib - Modules that are not frozen and will be uploaded as code/bytecode.
- /main.py - The entry point of the project.
If you want you can freeze it in the firmware by setting FREEZE_MAIN environment variable to true.
This will add it to generated manifest.py
- /build - The output directory of the container. 
After a successful build you should be able to locate the firmware in this directory.
The firmware will be a .bin, .hex or .uf2 file depending on the port.
- /build_firmware.sh - There is already a build_fimrware.sh integrated in the container. If this file exists it will overwrite the integrated file.
- /manifest.py - The manifest file used to MAKE the firmware. If this file exists it will overwrite the file generated by build_firmware.sh

### Environment variables.
The container uses environment variables as input.

- PORT - The port of MicroPython.
- BOARD - The board for which the firmware is intended. 
It should be <b>EXACTLY</b> the same as in <b>micropython/ports/$PORT/boards</b>.
- FREEZE_MAIN - Set it to true if you want to freeze your /main.py inside the firmware.
This allows to start execution without uploading any other files.

### Workflow
You can run the commands yourself or automate it using script or CI/CD. \

#### Manula build
<code>
docker pull rav3nh01m/micropython:latest 

docker run --rm -v ./:/project rav3nh01m/micropython:latest
</code>

You can use any version of MicroPython available in the set by changing <b>lateest</b> to the version you want. \
After the build is compleated the firmware will be in /build directory of your project.